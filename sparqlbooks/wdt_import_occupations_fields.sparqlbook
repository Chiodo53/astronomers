[
  {
    "kind": 1,
    "language": "markdown",
    "value": "# Import occupations and fields",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Number of persons \nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nSELECT (COUNT(*) as ?n)\nWHERE {\n    GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n        {?s a wd:Q5.}\n}\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nSELECT ?s ?label ?birthYear\nWHERE {\n    GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n        {?s a wd:Q5;\n            rdfs:label ?label;\n            wdt:P569 ?birthYear}\n}\nORDER BY ?s\nLIMIT 3\n",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "## Occupations",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "## Explorer les occupations\n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\n\nSELECT ?item ?occupation ?occupationLabel \nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n       LIMIT 100\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P106 ?occupation.\n                BIND (?occupationLabel as ?occupationLabel)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n            }\n                \n        }\nORDER BY ?item ?occupation\nlimit 20\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\n\nSELECT ?item ?occupation ?occupationLabel ?occupation_1 ?occupation_1Label\nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n       LIMIT 5\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P106 ?occupation.\n                ?item wdt:P106 ?occupation_1.\n                FILTER (str(?occupation) < str(?occupation_1))\n                BIND (?occupationLabel as ?occupationLabel)\n                BIND (?occupation_1Label as ?occupation_1Label)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n            }\n                \n        }\n\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "## Effectifs\n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\n\nSELECT ?occupation ?occupationLabel (COUNT(*) as ?n)\nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n       LIMIT 10000\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P106 ?occupation.\n                BIND (?occupationLabel as ?occupationLabel)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n            }\n                \n        }\nGROUP BY ?occupation ?occupationLabel\nORDER BY DESC(?n)\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Prepare the data to be imported\n# With LIMIT clause \n## Apparently labels are not repeated if already available\n# We therefore car integrate them directly in the INSERT below\n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\n\nCONSTRUCT {?item wdt:P106 ?occupation.\n            ?occupation rdfs:label ?occupationLabel}\nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n        LIMIT 10\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P106 ?occupation.\n                BIND (?occupationLabel as ?occupationLabel)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n            }\n                \n        }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### This insert query has to be carried out directly on the Allegrograph server\n## Also, you have to carry it out in three steps. The accepted limit by Wikidata \n## of instances in a variable ('item' in our case) appears to be 10000.\n## You therefore have to have three steps for a population of around 23000 persons  \n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\n\nWITH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\nINSERT {?item wdt:P106 ?occupation.\n         ?occupation rdfs:label ?occupationLabel}\nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        #OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n        LIMIT 10000\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P106 ?occupation.\n                BIND (?occupationLabel as ?occupationLabel)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n            }\n                \n        }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Insert the label of the property\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\n\nINSERT DATA {\n  GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n  {wdt:P106 rdfs:label 'occupation'.}\n}",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "### Add the Occupation class",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "###  Inspect the occupations:\n# number of different occupations\n\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nSELECT (COUNT(*) as ?n)\nWHERE\n   {\n   SELECT DISTINCT ?occupation\n   WHERE {\n      GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n         {\n            ?s wdt:P106 ?occupation.\n         }\n      }\n   }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "https://www.wikidata.org/wiki/Q12737077",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Insert the class 'occupation' for all the occupations\n# Please note that strictly speaking Wikidata has no ontology,\n# therefore no classes. We add this for our convenience\n\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nWITH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\nINSERT {\n   ?occupation rdf:type wd:Q12737077.\n}\nWHERE\n   {\n   SELECT DISTINCT ?occupation\n   WHERE {\n         {\n            ?s wdt:P106 ?occupation.\n         }\n      }\n   }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Ajouter le label pour le concept Country\n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX owl: <http://www.w3.org/2002/07/owl#>\n\nINSERT DATA {\nGRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n    {    wd:Q12737077 rdfs:label \"Occupation\".\n    }    \n}\n\n",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "### Inspect the available information\n\nWith the queries [in this sparqlbook](wdt_available_information.sparqlbook) you can inspect the available information",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Basic query about persons' occupation\n\nPREFIX franzOption_defaultDatasetBehavior: <franz:rdf>\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n\nSELECT ?occupation ?occupationLabel (COUNT(*) as ?n)\nWHERE {\n    GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n        {?item wdt:P106 ?occupation.\n        OPTIONAL {?occupation rdfs:label ?occupationLabel}    \n          }\n}\nGROUP BY ?occupation ?occupationLabel \nORDER BY DESC(?n)\nLIMIT 30",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "## Fields\n\nNoter qu'il y a deux méthodes pour récupérer les champs 'activité: directe et indirecte",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### This insert query has to be carried out directly on the Allegrograph server\n## Also, you have to carry it out in three steps. The accepted limit by Wikidata \n## of instances in a variable ('item' in our case) appears to be 10000.\n## You therefore have to have three steps for a population of around 23000 persons  \n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n\nCONSTRUCT {?item wdt:P101 ?field}\nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n        LIMIT 10\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P101 ?field.\n            }\n                \n        }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### This insert query has to be carried out directly on the Allegrograph server\n## Also, you have to carry it out in three steps. The accepted limit by Wikidata \n## of instances in a variable ('item' in our case) appears to be 10000.\n## You therefore have to have three steps for a population of around 23000 persons  \n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n\nWITH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\nINSERT {?item wdt:P101 ?field}\nWHERE\n    {\n        ## Find the persons in the imported graph\n        {SELECT ?item\n        WHERE \n                {?item a wd:Q5.}\n        ORDER BY ?item      \n        OFFSET 0\n        #OFFSET 10000\n        #OFFSET 20000\n        LIMIT 10000\n\n        }\n        ## \n        SERVICE <https://query.wikidata.org/sparql>\n            {\n                ?item wdt:P101 ?field.\n            }\n                \n        }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "\n\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n\n\n\nSELECT DISTINCT ?occupation ?occupationType\nWHERE {\n   GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n   {\n\n    ?item wdt:P106 ?occupation.\n    ?occupation a wd:Q29028649\n    #?occupation a ?occupationType.\n    \n    \n   } \n}\nlimit 20",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Prepare and inspect the data to be inserted\n\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nCONSTRUCT  {\n    ?o rdfs:label ?oLabel.\n    ?o a ?class.\n    ?class rdfs:label ?classLabel   \n}\n#SELECT DISTINCT ?o ?oLabel  ?class ?classLabel\nWHERE {\n\n    {\n        SELECT DISTINCT ?o\n    WHERE {\n        GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n            {\n                ?s wdt:P101|wdt:P106 ?o.\n            }\n            }\n    LIMIT 10\n    }\n\n    SERVICE <https://query.wikidata.org/sparql>\n                {\n                    OPTIONAL{?o wdt:P31 ?class.}\n                BIND (?oLabel as ?oLabel)\n                BIND (?classLabel as ?classLabel)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n                }\n\n\n\n}",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "### Insert the data\n# Beware to use the right GRAPH in your repository\n\n\nPREFIX wikibase: <http://wikiba.se/ontology#>\nPREFIX bd: <http://www.bigdata.com/rdf#>\nPREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nWITH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\nINSERT  {\n    ?o rdfs:label ?oLabel.\n    ?o a ?class.\n    ?class rdfs:label ?classLabel   \n}\nWHERE {\n\n    {\n        SELECT DISTINCT ?o\n        WHERE \n            {\n                ?s wdt:P101|wdt:P106 ?o.\n            }\n                \n    }\n\n    SERVICE <https://query.wikidata.org/sparql>\n                {\n                    OPTIONAL{?o wdt:P31 ?class.}\n                BIND (?oLabel as ?oLabel)\n                BIND (?classLabel as ?classLabel)\n                SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". } \n                }\n\n}",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nSELECT ?occupation ?occupationLabel (COUNT(*) as ?number)\nWHERE \n{\n    GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n    {\n        ?s wdt:P106 ?occupation.\n        ?occupation rdfs:label ?occupationLabel\n    }\n}\nGROUP BY ?occupation ?occupationLabel\nORDER BY DESC(?number)\nLIMIT 10",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nSELECT ?occupation ?occupationLabel (COUNT(*) as ?number)\nWHERE \n{\n    GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n    {\n        ?s wdt:P106 ?occupation.\n        ?occupation rdfs:label ?occupationLabel\n    }\n}\nGROUP BY ?occupation ?occupationLabel\nORDER BY DESC(?number)",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX wd: <http://www.wikidata.org/entity/>\nPREFIX wdt: <http://www.wikidata.org/prop/direct/>\n\nSELECT ?field ?fieldLabel ?fieldType (COUNT(*) as ?number)\nWHERE \n{\n    GRAPH <https://github.com/Sciences-historiques-numeriques/astronomers/blob/main/graphs/wikidata-imported-data.md>\n    {\n        ?s wdt:P101 ?field.\n        ?field rdfs:label ?fieldLabel\n        OPTIONAL {?field a ?fieldType}\n    }\n}\nGROUP BY ?field ?fieldLabel ?fieldType\nORDER BY DESC(?number)\nOFFSET 10\nLIMIT 10",
    "metadata": {}
  }
]